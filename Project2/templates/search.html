{% extends "base.html" %}
{% block title %}Search – Photo Gallery{% endblock %}
{% block content %}
<h2 class="mb-4"><i class="bi bi-search"></i> Search Photos</h2>

<form method="GET" action="{{ url_for('search') }}" class="mb-4">
  <div class="input-group">
    <input type="text" class="form-control" name="q"
           value="{{ query }}"
           placeholder="Search by filename, tags, or description…" autofocus>
    <button class="btn btn-primary" type="submit">
      <i class="bi bi-search"></i> Search
    </button>
  </div>
</form>

{% if query %}
<p class="text-muted">
  Found <strong>{{ photos|length }}</strong> result(s) for
  "<em>{{ query }}</em>"
</p>
{% endif %}

{% if photos %}
<div class="row g-4">
  {% for photo in photos %}
  <div class="col-sm-6 col-md-4 col-lg-3">
    <div class="card h-100 shadow-sm photo-card">
      <div class="card-img-top-wrapper">
        <img src="{{ url_for('download', photo_id=photo.photo_id) }}"
             class="card-img-top" alt="{{ photo.filename }}" loading="lazy">
      </div>
      <div class="card-body">
        <h6 class="card-title text-truncate" title="{{ photo.filename }}">
          {{ photo.filename }}
        </h6>
        {% if photo.tags %}
        <p class="card-text">
          {% for tag in photo.tags.split(',') %}
          <span class="badge bg-info text-dark">{{ tag.strip() }}</span>
          {% endfor %}
        </p>
        {% endif %}
        {% if photo.description %}
        <p class="card-text small text-muted">{{ photo.description }}</p>
        {% endif %}
      </div>
      <div class="card-footer bg-white">
        <a href="{{ url_for('download', photo_id=photo.photo_id) }}"
           class="btn btn-sm btn-outline-primary">
          <i class="bi bi-download"></i> Download
        </a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% elif query %}
<div class="text-center py-5">
  <i class="bi bi-emoji-frown" style="font-size:3rem;color:#ccc;"></i>
  <p class="mt-3 text-muted">No photos match your search.</p>
</div>
{% endif %}
{% endblock %}
